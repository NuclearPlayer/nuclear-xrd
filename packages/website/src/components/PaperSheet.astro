---
type PaperColor = 'default' | 'primary' | 'purple' | 'pink' | 'orange' | 'cyan' | 'white';

type Props = {
  color?: PaperColor;
  rotation?: 'none' | 'random';
  showGrid?: boolean;
  class?: string;
};

const {
  color = 'default',
  rotation = 'random',
  showGrid = false,
  class: className = '',
} = Astro.props;

const colorClasses: Record<PaperColor, string> = {
  default: 'bg-background',
  primary: 'bg-primary',
  purple: 'bg-accent-purple',
  pink: 'bg-pink-400',
  orange: 'bg-accent-orange',
  cyan: 'bg-accent-cyan',
  white: 'bg-white',
};

const getRotationStyle = (rot: string): string => {
  if (rot === 'none') return '';

  // Random rotation between -1.5 and 1.5 degrees
  const angle = (Math.random() * 3 - 1.5).toFixed(2);
  return `transform: rotate(${angle}deg);`;
};

const rotationStyle = getRotationStyle(rotation);
---

<section
  class:list={[
    'paper-sheet relative overflow-hidden',
    colorClasses[color],
    className,
  ]}
  style={rotationStyle}
>
  {
    showGrid && (
      <div
        class="absolute inset-0 bg-grid-pattern opacity-10 pointer-events-none"
        aria-hidden="true"
      />
    )
  }

  <slot name="doodles" />

  <div
    class="absolute inset-0 bg-paper-texture mix-blend-multiply opacity-[0.7] pointer-events-none z-20"
    aria-hidden="true"
  >
  </div>

  <div class="relative z-10">
    <slot />
  </div>
</section>
